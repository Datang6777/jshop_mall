webpackJsonp([20],{"/AAr":function(t,s,o){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=o("IHPB"),a=o.n(i),e=o("2oac"),n=(o("4REz"),{props:{config:"config",product:{type:[Object,Array],default:function(){return{}}},brief:{type:String},buyCount:{type:Number},unit:{type:String},img:{type:String},name:{type:String}},data:function(){return{browserShow:!1,url:"",source:"",title:"",description:"",image:"",sites:["qzone","qq","weibo","wechat","douban"],disabled:["google","facebook","twitter"],wechatQrcodeTitle:"微信扫一扫：分享",wechatQrcodeHelper:"<p>微信里点“发现”，扫一下</p><p>二维码便可将本文分享至朋友圈。</p>",weiXinBrowserShow:!1}},methods:{share:function(){this.GLOBAL.isWeiXinBrowser()?this.weiXinBrowserShow=!0:this.browserShow=!0}}}),r={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"goodstitle"},[i("div",{staticClass:"goodsheader"},[i("div",{staticClass:"goodsheader-left"},[i("h3",{staticClass:"goodsname"},[t._v(t._s(t.product.name))]),t._v(" "),i("p",[t._v(t._s(t.brief))])]),t._v(" "),i("yd-button",{staticClass:"share",nativeOn:{click:function(s){return t.share()}}},[i("img",{attrs:{src:o("ILAY")}}),t._v(" "),i("p",[t._v("分享")])])],1),t._v(" "),i("div",{staticClass:"price-salesvolume"},[i("div",{staticClass:"price"},[i("h2",[t._v("￥"+t._s(this.GLOBAL.formatMoney(t.product.price,2,"")))]),t._v(" "),i("p",[t._v("￥"+t._s(t.product.mktprice))])]),t._v(" "),i("div",{staticClass:"salesvolume"},[i("p",[t._v("销量："+t._s(t.buyCount)+" "+t._s(t.unit))])])]),t._v(" "),i("yd-popup",{attrs:{position:"center",width:"90%"},model:{value:t.browserShow,callback:function(s){t.browserShow=s},expression:"browserShow"}},[i("div",{staticStyle:{"background-color":"#fff",padding:"20px"}},[i("share",{attrs:{config:t.config}})],1)]),t._v(" "),i("yd-popup",{staticClass:"wechatshare",attrs:{position:"center",width:"90%"},model:{value:t.weiXinBrowserShow,callback:function(s){t.weiXinBrowserShow=s},expression:"weiXinBrowserShow"}},[i("img",{staticClass:"wechatshare-img",attrs:{src:o("lzL5")}})])],1)},staticRenderFns:[]},c=o("C7Lr")(n,r,!1,null,null,null).exports,d=o("VOUH"),u=o("PFDR"),l=o("L+nx"),p={props:{is_fav:{type:Boolean,default:function(){return!1}},cart_nums:{type:Number,default:function(){return 0}}},methods:{addCart:function(){this.$emit("addCart")},buyNow:function(){this.$emit("buyNow")},collection:function(){this.$emit("collection")},showChat:function(){window._AIHECONG("ini",{entId:this.GLOBAL.hecong(),button:!1,appearance:{panelMobile:{tone:"#FF3B44",sideMargin:30,ratio:"part",headHeight:50}}}),window._AIHECONG("showChat")}}},m={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"goodsdetailfooter"},[i("div",{staticClass:"goodsdetailfooter-left"},[i("div",{staticClass:"customservice",on:{click:t.showChat}},[i("img",{attrs:{src:o("OsEz")}}),t._v(" "),i("p",[t._v("客服")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.is_fav,expression:"!is_fav"}],staticClass:"goods-cart",on:{click:t.collection}},[i("img",{attrs:{src:o("75rK")}}),t._v(" "),i("p",[t._v("收藏")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.is_fav,expression:"is_fav"}],staticClass:"goods-cart",on:{click:t.collection}},[i("img",{attrs:{src:o("SCM3")}}),t._v(" "),i("p",[t._v("取消收藏")])]),t._v(" "),i("router-link",{staticClass:"star",attrs:{tag:"div",to:"/cart"}},[i("img",{attrs:{src:o("7F5C")}}),t._v(" "),t.cart_nums?i("yd-badge",{attrs:{type:"danger"}},[t._v(t._s(t.cart_nums))]):t._e(),t._v(" "),i("p",[t._v("购物车")])],1)],1),t._v(" "),i("div",{staticClass:"goodsdetailfooter-right"},[i("div",{staticClass:"addtocart"},[i("yd-button",{attrs:{type:"danger"},nativeOn:{click:function(s){return t.addCart(s)}}},[t._v("加入购物车")])],1),t._v(" "),i("div",{staticClass:"buynow"},[i("yd-button",{attrs:{type:"danger"},nativeOn:{click:function(s){return t.buyNow(s)}}},[t._v("立即购买")])],1)])])},staticRenderFns:[]};var g=o("C7Lr")(p,m,!1,function(t){o("eVZh")},null,null).exports,v={data:function(){return{page:1,pageSize:5,goodsId:this.$route.query.goods_id?this.$route.query.goods_id:"",goodsData:[],productSpes:[],promotion:[],stock:"",params:[],comment:[],load:!0,is_fav:!1,num:1,cart_nums:0}},components:{slider:e.a,goodstitle:c,goodsservice:d.a,goodsstandard:u.a,goodsnum:l.a,goodsdetailfooter:g},created:function(){this.goodsDetail(),this.goodsParams(),this.goodsComment(),this.getCartNums()},computed:{checkPromotion:function(){if(this.promotion){var t=[];for(var s in this.promotion)2!==this.promotion[s].type&&1!==this.promotion[s].type||t.push(this.promotion[s]);return t}}},methods:{goodsDetail:function(){var t=this;this.$api.goodsDetail({id:this.goodsId,token:this.GLOBAL.getStorage("user_token")},function(s){s.status&&0!==s.data.length?(t.goodsData=s.data,"false"===s.data.isfav?t.is_fav=!1:t.is_fav=!0,t.productSpes=s.data.product,t.promotion=s.data.product.promotion_list,t.GLOBAL.getStorage("user_token")&&t.goodsBrowsing(),t.weixinConfig()):t.$dialog.alert({mes:"该商品不存在",callback:function(){t.$router.go(-1)}})})},goodsParams:function(){var t=this;this.$api.goodsParams({id:this.goodsId},function(s){s.status&&(t.params=s.data)})},goodsComment:function(){var t=this;this.$api.goodsComment({page:this.page,limit:this.pageSize,goods_id:this.goodsId},function(s){if(s.status){var o=s.data.list,i=s.data.count;for(var e in o)o[e].ctime=t.GLOBAL.timeToDate(o[e].ctime);o.length>=i&&(t.load=!1),t.comment=[].concat(a()(o))}})},loadMore:function(){var t=this;this.$api.goodsComment({page:++this.page,limit:this.pageSize,goods_id:this.goodsId},function(s){if(s.status){var o=s.data.list,i=s.data.count;for(var e in o)o[e].ctime=t.GLOBAL.timeToDate(o[e].ctime);t.comment=[].concat(a()(t.comment),a()(o)),t.comment.length>=i&&(t.load=!1)}})},weixinConfig:function(){this.GLOBAL.isWeiXinBrowser()&&this.$api.weixinShare(this.goodsData.name,this.goodsData.image_url,this.goodsData.brief)},getCartNums:function(){var t=this,s=this.GLOBAL.getStorage("user_token");s&&this.$api.getCartNum({token:s},function(s){s.status&&(t.cart_nums=s.data)})},changeSpes:function(t){var s=this;this.$api.getProductInfo({id:t},function(t){t.status&&(s.productSpes=t.data)})},goodsNum:function(t){this.num=t},goodsBrowsing:function(){this.$api.addGoodsBrowsing({goods_id:this.goodsData.id},function(t){})},collection:function(){var t=this;this.$api.goodsCollection({goods_id:this.goodsData.id},function(s){s.status&&(t.is_fav=!t.is_fav,t.$dialog.toast({mes:s.msg,timeout:1e3}))})},add:function(){var t=this;this.$api.addCart({product_id:this.productSpes.id,nums:this.num},function(s){s.status&&(t.getCartNums(),t.$dialog.toast({mes:s.msg,timeout:1e3,icon:"success"}))})},buyNow:function(){var t=this;this.$api.addCart({product_id:this.productSpes.id,nums:this.num,type:2},function(s){if(s.status){var o=s.data;t.$router.push({path:"/firmorder",query:{cartIds:o}})}})},goBack:function(){if(window.history.length<=1)return this.$router.push({path:"/"}),!1;this.$router.go(-1)}}},h={render:function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("div",{staticClass:"goodsdetail"},[o("div",{staticClass:"goodsdetail-back"},[o("i",{staticClass:"iconfont icon-zuo",on:{click:t.goBack}})]),t._v(" "),o("slider",{attrs:{imgList:t.goodsData.album}}),t._v(" "),o("goodstitle",{attrs:{product:t.productSpes,brief:t.goodsData.brief,buyCount:t.goodsData.buy_count,unit:t.goodsData.unit}}),t._v(" "),o("goodsservice",{attrs:{promotion:t.checkPromotion}}),t._v(" "),o("goodsstandard",{attrs:{spes:t.productSpes.default_spes_desc},on:{changeSpes:t.changeSpes}}),t._v(" "),o("goodsnum",{attrs:{stock:t.productSpes.stock,unit:t.goodsData.unit},on:{num:t.goodsNum}}),t._v(" "),o("yd-tab",[o("yd-tab-panel",{attrs:{label:"图文详情"}},[o("ul",{domProps:{innerHTML:t._s(t.goodsData.intro)}})]),t._v(" "),o("yd-tab-panel",{staticClass:"params",attrs:{label:"产品参数"}},[t.params.length?o("ul",t._l(t.params,function(s,i){return o("li",{key:i},[s.value?o("div",[o("span",{attrs:{id:"paramsleft"}},[t._v(t._s(s.name)+" : ")]),o("span",{attrs:{id:"paramsright"}},[t._v(t._s(s.value))])]):t._e()])}),0):o("ul",[t._v("没有详细参数")])]),t._v(" "),o("yd-tab-panel",{staticClass:"comment",attrs:{label:"买家评论"}},[o("ul",[t._l(t.comment,function(s,i){return o("li",{key:i},[o("div",{staticClass:"comment-info"},[o("img",{staticClass:"user-img",attrs:{src:s.user.avatar,alt:""}}),t._v(" "),o("p",{staticClass:"user-name"},[t._v(t._s(s.user.nickname))]),t._v(" "),o("yd-rate",{attrs:{slot:"left",readonly:!0,size:".2rem"},slot:"left",model:{value:s.score,callback:function(o){t.$set(s,"score",o)},expression:"item.score"}})],1),t._v(" "),o("p",[t._v(t._s(s.ctime)+"      "+t._s(s.addon))]),t._v(" "),o("p",[t._v(t._s(s.content))]),t._v(" "),o("yd-lightbox",{staticClass:"comment-imgs"},[t._l(s.images_url,function(t,s){return o("yd-lightbox-img",{key:s,staticClass:"comment-img",attrs:{src:t}})}),t._v(" "),o("yd-lightbox-txt",[o("h1",{attrs:{slot:"top"},slot:"top"},[o("div",{},[o("p",{staticClass:"user-name"},[t._v(t._s(s.user.nickname))]),t._v(" "),o("yd-rate",{attrs:{slot:"left",readonly:!0,size:".2rem"},slot:"left",model:{value:s.score,callback:function(o){t.$set(s,"score",o)},expression:"item.score"}})],1)]),t._v(" "),o("div",{attrs:{slot:"content"},slot:"content"},[o("p",[t._v(t._s(s.content))])]),t._v(" "),o("div",{attrs:{slot:"bottom"},slot:"bottom"},[o("p",[t._v(t._s(s.ctime))])])])],2)],1)}),t._v(" "),o("li",{staticStyle:{"text-align":"center"}},[t.load?o("yd-button",{attrs:{size:"small",type:"hollow",color:"#F00",shape:"circle"},nativeOn:{click:function(s){return t.loadMore(s)}}},[t._v("加载更多评论")]):o("yd-button",{attrs:{size:"small",type:"hollow",color:"#AAA",shape:"circle"}},[t._v("没有更多评论了")])],1)],2)])],1),t._v(" "),o("goodsdetailfooter",{attrs:{is_fav:t.is_fav,cart_nums:t.cart_nums},on:{collection:t.collection,addCart:t.add,buyNow:t.buyNow}})],1)},staticRenderFns:[]};var _=o("C7Lr")(v,h,!1,function(t){o("z73v")},null,null);s.default=_.exports},eVZh:function(t,s){},z73v:function(t,s){}});
//# sourceMappingURL=20.44af8a114ef92bc5f0b5.js.map