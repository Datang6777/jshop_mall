{"version":3,"sources":["webpack:///src/pages/goods/GoodsList.vue","webpack:///./src/pages/goods/GoodsList.vue?e8ff","webpack:///./src/pages/goods/GoodsList.vue"],"names":["GoodsList","data","page","pageSize","label","title","checked","top","bottom","condition","icons","topChecked","bottomChecked","checkedFilter","filter","this","GLOBAL","getStorage","catId","$route","query","cat_id","brand","hot","keywords","list","mounted","_this","arr","split","forEach","v","k","goodsList","methods","clickFilter","index","_this2","str","setStorage","$refs","infinitescrollDemo","$emit","_this3","$api","conditions","res","_list","concat","toConsumableArray_default","length","loadMore","_this4","where","search_name","brand_id","limit","stringify_default","beforeRouteLeave","to","from","next","path","removeStorage","goods_GoodsList","render","_vm","_h","$createElement","_c","_self","staticClass","_l","item","key","class","active","on","click","$event","_v","_s","attrs","src","_e","ref","callback","distance","scroll-top","slot","theme","type","href","goods_id","id","image_url","name","price","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/32.5e59cc91ac8c3ae08dd5.js","sourcesContent":["<template>\r\n    <div class=\"goodslist\">\r\n        <div class=\"itembox\">\r\n            <ul>\r\n                <li v-for=\"(item, index) in label\" :key=\"index\">\r\n                    <span :class=\"{active: item.checked}\" @click=\"clickFilter(index)\">{{ item.title }}</span>\r\n                    <div class=\"sort-img\">\r\n                        <img class=\"top\" :src=\"item.top ? icons.topChecked : icons.top\" v-if=\"index\"/>\r\n                        <img class=\"bottom\" :src=\"item.bottom ? icons.bottomChecked : icons.bottom\" />\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" :scroll-top=\"false\" ref=\"infinitescrollDemo\" class=\"itemgoodslist\">\r\n            <yd-list theme=\"4\" slot=\"list\">\r\n                <yd-list-item v-for='(item, key) in list' :key='key' type=\"link\" :href=\"{path:'goodsdetail',query:{goods_id:item.id}}\">\r\n                    <img slot='img' :src='item.image_url'>\r\n                    <span slot='title'>{{item.name}}</span>\r\n                    <yd-list-other slot='other'>\r\n                        <div>\r\n                            <span class='demo-list-price'><em>¥</em>{{item.price}}</span>\r\n                        </div>\r\n                    </yd-list-other>\r\n                </yd-list-item>\r\n            </yd-list>\r\n        </yd-infinitescroll>\r\n        <yd-backtop></yd-backtop>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data () {\r\n        return {\r\n            page: 1,\r\n            pageSize: 10, // 每页10条数据\r\n            label: [\r\n                {title: '综合', checked: true, top: false, bottom: true, condition: ''},\r\n                {title: '销量', checked: false, top: false, bottom: false, condition: 'buy_count'},\r\n                {title: '价格', checked: false, top: false, bottom: false, condition: 'price'}\r\n            ],\r\n            icons: {\r\n                top: './static/image/graytop.png',\r\n                topChecked: './static/image/redtop.png',\r\n                bottom: './static/image/graybottom.png',\r\n                bottomChecked: './static/image/redbottom.png'\r\n            },\r\n            checkedFilter: 0, // 选中的第几个搜索条件 区分再次点击\r\n            filter: this.GLOBAL.getStorage('filter') ? this.GLOBAL.getStorage('filter') : '', // order查询的筛选条件\r\n            catId: this.$route.query.cat_id || 0, // 分类条件\r\n            brand: this.$route.query.brand, // 品牌id\r\n            hot: this.$route.query.hot || 0, // 热门\r\n            keywords: this.$route.query.keywords || 0, // 搜索条件\r\n            list: [] // 指定分类的商品数据\r\n        }\r\n    },\r\n    mounted () {\r\n        if (this.GLOBAL.getStorage('filter')) {\r\n            // 从本地取出筛选状态\r\n            let arr = this.GLOBAL.getStorage('filter').split(' ')\r\n            this.label.forEach((v, k) => {\r\n                if (v.condition === arr[0]) {\r\n                    this.checkedFilter = k // 第几个筛选条件选中\r\n                    v.checked = true\r\n                    arr[1] === 'asc' ? v.top = true : v.top = false\r\n                    arr[1] === 'desc' ? v.bottom = true : v.bottom = false\r\n                } else {\r\n                    v.checked = false\r\n                    v.top = false\r\n                    v.bottom = false\r\n                }\r\n            })\r\n        } else {\r\n            // 否则选中默认的\r\n            this.label[0].checked = true\r\n        }\r\n        this.goodsList()\r\n    },\r\n    methods: {\r\n        // 筛选条件点击\r\n        clickFilter (index) {\r\n            // 如果已经是选中的 再次点击切换倒序升序切换 且不是综合的筛选\r\n            if (this.checkedFilter === index) {\r\n                if (index !== 0) {\r\n                    this.label[index].top = !this.label[index].top\r\n                    this.label[index].bottom = !this.label[index].bottom\r\n                } else {\r\n                    return false\r\n                }\r\n            } else {\r\n                // 否则切换对应的筛选条件\r\n                this.label.forEach((v, k) => {\r\n                    if (k === index) {\r\n                        this.checkedFilter = index\r\n                        v.checked = true\r\n                        // 此处默认销量降序 价格升序\r\n                        // 销量 k = 1 价格 k = 2\r\n                        if (k === 2) {\r\n                            v.top = true\r\n                        } else {\r\n                            v.bottom = true\r\n                        }\r\n                    } else {\r\n                        v.checked = false\r\n                        v.top = false\r\n                        v.bottom = false\r\n                    }\r\n                })\r\n            }\r\n            // 拼接搜索条件\r\n            let str = ''\r\n            if (this.label[index].condition) str = this.label[index].top ? ' asc' : ' desc'\r\n            this.filter = this.label[index].condition + str\r\n            this.GLOBAL.setStorage('filter', this.filter)\r\n            this.page = 1 // 筛选条件重新第一页开始\r\n            this.list = []\r\n            this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.reInit');\r\n            this.goodsList()\r\n        },\r\n        // 获取商品数据\r\n        goodsList () {\r\n            this.$api.goodsList(this.conditions(), res => {\r\n                const _list = res.data.list\r\n                this.list = [..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                }\r\n                this.page++\r\n            })\r\n        },\r\n        // 加载更多\r\n        loadMore () {\r\n            this.$api.goodsList(this.conditions(), res => {\r\n                const _list = res.data.list\r\n                this.list = [...this.list, ..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                }\r\n                /* 单次请求数据完毕 */\r\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\r\n                this.page++\r\n            })\r\n        },\r\n        // 统一返回筛选条件 查询条件 分页\r\n        conditions () {\r\n            let where = {}\r\n            if (this.catId) {\r\n                where = {cat_id: this.catId}\r\n            } else if (this.hot) {\r\n                where = {hot: this.hot}\r\n            } else if (this.keywords) {\r\n                where = {search_name: this.keywords}\r\n            } else if (this.brand) {\r\n                where = {brand_id: this.brand}\r\n            }\r\n            let data = {\r\n                page: this.page,\r\n                limit: this.pageSize,\r\n                where: JSON.stringify(where)\r\n            }\r\n            if (this.filter) data['order'] = this.filter\r\n            return data\r\n        }\r\n    },\r\n    // 路由离开 如果不是进入商品详情页则清除筛选状态\r\n    beforeRouteLeave (to, from, next) {\r\n        if (to.path !== '/goodsdetail') {\r\n            this.GLOBAL.removeStorage('filter')\r\n        }\r\n        next()\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n    .goodslist  .itemgoodslist{\r\n        margin-top: .8rem;\r\n    }\r\n    .goodslist .itembox{\r\n        overflow: hidden;\r\n        zoom: 1;\r\n        background: #fff;\r\n        border-bottom: solid 1px #f5f5f5;\r\n        position: fixed;\r\n        top: 1rem;\r\n        width: 100%;\r\n        z-index: 99999;\r\n        padding: .1rem 0;\r\n        max-width: 750px;\r\n    }\r\n    .goodslist .itembox ul li{\r\n        width: 33.3%;\r\n        float: left;\r\n        height: .6rem;\r\n        line-height: .6rem;\r\n        position: relative;\r\n    }\r\n    .goodslist .itembox ul li img{\r\n        /*vertical-align: middle;*/\r\n    }\r\n    .goodslist .itembox .sort-img{\r\n        display: inline-block;\r\n        position: absolute;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        margin-left: .05rem;\r\n    }\r\n    .goodslist .itembox .sort-img img{\r\n        display: block;\r\n        width: .2rem;\r\n    }\r\n    .goodslist .itembox .sort-img img:nth-child(2n){\r\n        margin-top: .05rem;\r\n    }\r\n    .active {\r\n        color: #FF3B44;\r\n    }\r\n    .goodslist .yd-list-theme4 .yd-list-item .yd-list-title{\r\n        -webkit-line-clamp: 2;\r\n    }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/goods/GoodsList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"goodslist\"},[_c('div',{staticClass:\"itembox\"},[_c('ul',_vm._l((_vm.label),function(item,index){return _c('li',{key:index},[_c('span',{class:{active: item.checked},on:{\"click\":function($event){return _vm.clickFilter(index)}}},[_vm._v(_vm._s(item.title))]),_vm._v(\" \"),_c('div',{staticClass:\"sort-img\"},[(index)?_c('img',{staticClass:\"top\",attrs:{\"src\":item.top ? _vm.icons.topChecked : _vm.icons.top}}):_vm._e(),_vm._v(\" \"),_c('img',{staticClass:\"bottom\",attrs:{\"src\":item.bottom ? _vm.icons.bottomChecked : _vm.icons.bottom}})])])}),0)]),_vm._v(\" \"),_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",staticClass:\"itemgoodslist\",attrs:{\"callback\":_vm.loadMore,\"distance\":2,\"scroll-top\":false}},[_c('yd-list',{attrs:{\"slot\":\"list\",\"theme\":\"4\"},slot:\"list\"},_vm._l((_vm.list),function(item,key){return _c('yd-list-item',{key:key,attrs:{\"type\":\"link\",\"href\":{path:'goodsdetail',query:{goods_id:item.id}}}},[_c('img',{attrs:{\"slot\":\"img\",\"src\":item.image_url},slot:\"img\"}),_vm._v(\" \"),_c('span',{attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('yd-list-other',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.price))])])])],1)}),1)],1),_vm._v(\" \"),_c('yd-backtop')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-72c1a156\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-72c1a156\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./GoodsList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./GoodsList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-72c1a156\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./GoodsList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/goods/GoodsList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}