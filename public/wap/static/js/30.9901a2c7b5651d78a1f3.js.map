{"version":3,"sources":["webpack:///src/pages/other/History.vue","webpack:///./src/pages/other/History.vue?8b0e","webpack:///./src/pages/other/History.vue"],"names":["History","data","page","pageSize","list","created","this","goodsBrowsing","methods","showDetail","goodsId","$router","push","path","query","goods_id","_this","$api","limit","res","_list","dateFormat","concat","toConsumableArray_default","length","$refs","infinitescrollDemo","$emit","loadMore","_this2","k","ctime","GLOBAL","timeToDate","skip","touchStart","e","startX","touches","clientX","touchEnd","parentElement","currentTarget","endX","changedTouches","dataset","type","restSlide","checkSlide","listItems","document","querySelectorAll","i","deleteItem","_this3","index","delGoodsBrowsing","goods_ids","status","$dialog","toast","mes","msg","timeout","icon","splice","other_History","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","callback","distance","slot","_l","item","key","data-type","staticStyle","padding","on","!touchstart","$event","!touchend","click","src","goods","image_url","_v","_s","goods_name","price","__webpack_require__","data-index","_e","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/30.9901a2c7b5651d78a1f3.js","sourcesContent":["<template>\r\n    <div class=\"history\">\r\n        <yd-infinitescroll :callback=\"loadMore\" :distance=\"2\" ref=\"infinitescrollDemo\">\r\n            <ul slot=\"list\">\r\n                <li class=\"list-item\" data-type=\"0\" v-for=\"(item, index) in list\" :key=\"index\" v-if=\"item.goods\">\r\n                    <div class=\"list-box\" style=\"padding: .15rem;\" @touchstart.capture=\"touchStart\" @touchend.capture=\"touchEnd\" @click=\"showDetail(item.goods_id)\">\r\n                        <img class=\"goodsimg\" slot=\"img\" :src=\"item.goods.image_url\">\r\n                        <div class=\"list-body\">\r\n                            <h3 class=\"goodsname\" slot=\"title\">{{ item.goods_name }}</h3>\r\n                            <div class=\"btn-numbox\">\r\n                                <div>\r\n                                    <span class=\"demo-list-price\"><em>¥</em>{{ item.goods.price }}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div slot=\"other\">\r\n                                <div>\r\n                                    <span class=\"time\">{{ item.ctime }}</span>\r\n                                </div>\r\n                            </div>\r\n                            <img class=\"right-img\" slot=\"other\" src=\"../../../static/image/right.png\"/>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"delete\" @click=\"deleteItem\" :data-index=\"index\">删除</div>\r\n                </li>\r\n            </ul>\r\n        </yd-infinitescroll>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    data () {\r\n        return {\r\n            page: 1,\r\n            pageSize: 10,\r\n            list: [] // 商品浏览足迹\r\n        }\r\n    },\r\n    created () {\r\n        this.goodsBrowsing()\r\n    },\r\n    methods: {\r\n        showDetail (goodsId) {\r\n            this.$router.push({path: '/goodsdetail', query: {goods_id: goodsId}})\r\n        },\r\n        goodsBrowsing () {\r\n            this.$api.goodsBrowsing({\r\n                page: this.page,\r\n                limit: this.pageSize\r\n            }, res => {\r\n                const _list = this.dateFormat(res.data.list)\r\n                this.list = [..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                }\r\n            })\r\n        },\r\n        // 加载更多\r\n        loadMore () {\r\n            this.$api.goodsBrowsing({\r\n                page: ++this.page,\r\n                limit: this.pageSize\r\n            }, res => {\r\n                const _list = this.dateFormat(res.data.list)\r\n                this.list = [...this.list, ..._list]\r\n                if (_list.length < this.pageSize) {\r\n                    /* 所有数据加载完毕 */\r\n                    this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.loadedDone')\r\n                    return\r\n                }\r\n                /* 单次请求数据完毕 */\r\n                this.$refs.infinitescrollDemo.$emit('ydui.infinitescroll.finishLoad')\r\n            })\r\n        },\r\n        dateFormat (list) {\r\n            for (let k in list) {\r\n                list[k].ctime = this.GLOBAL.timeToDate(list[k].ctime)\r\n            }\r\n            return list\r\n        },\r\n        // 跳转\r\n        skip () {\r\n        // if (this.checkSlide()) {\r\n        //    this.restSlide()\r\n        // } else {\r\n        //    alert('You click the slide!')\r\n        // }\r\n        },\r\n        // 滑动开始\r\n        touchStart (e) {\r\n            // 记录初始位置\r\n            this.startX = e.touches[0].clientX\r\n        },\r\n        // 滑动结束\r\n        touchEnd (e) {\r\n            // 当前滑动的父级元素\r\n            let parentElement = e.currentTarget.parentElement\r\n            // 记录结束位置\r\n            this.endX = e.changedTouches[0].clientX\r\n            // 左滑\r\n            if (parentElement.dataset.type === '0' && this.startX - this.endX > 30) {\r\n                this.restSlide()\r\n                parentElement.dataset.type = 1\r\n            }\r\n            // 右滑\r\n            if (parentElement.dataset.type === '1' && this.startX - this.endX < -30) {\r\n                this.restSlide()\r\n                parentElement.dataset.type = 0\r\n            }\r\n            this.startX = 0\r\n            this.endX = 0\r\n        },\r\n        // 判断当前是否有滑块处于滑动状态\r\n        checkSlide () {\r\n            let listItems = document.querySelectorAll('.list-item')\r\n            for (let i = 0; i < listItems.length; i++) {\r\n                if (listItems[i].dataset.type === '1') {\r\n                    return true\r\n                }\r\n            }\r\n            return false\r\n        },\r\n        // 复位滑动状态\r\n        restSlide () {\r\n            let listItems = document.querySelectorAll('.list-item')\r\n            // 复位\r\n            for (let i = 0; i < listItems.length; i++) {\r\n                listItems[i].dataset.type = 0\r\n            }\r\n        },\r\n        // 删除\r\n        deleteItem (e) {\r\n            // 当前索引\r\n            let index = e.currentTarget.dataset.index\r\n            this.$api.delGoodsBrowsing({\r\n                goods_ids: this.list[index].goods_id\r\n            }, res => {\r\n                if (res.status) {\r\n                    this.$dialog.toast({mes: res.msg, timeout: 1000, icon: 'success'})\r\n                    // 复位\r\n                    this.restSlide()\r\n                    // 删除\r\n                    this.list.splice(index, 1)\r\n                } else {\r\n                    this.$dialog.toast({mes: res.msg, timeout: 1000, icon: 'error'})\r\n                }\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/other/History.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"history\"},[_c('yd-infinitescroll',{ref:\"infinitescrollDemo\",attrs:{\"callback\":_vm.loadMore,\"distance\":2}},[_c('ul',{attrs:{\"slot\":\"list\"},slot:\"list\"},_vm._l((_vm.list),function(item,index){return (item.goods)?_c('li',{key:index,staticClass:\"list-item\",attrs:{\"data-type\":\"0\"}},[_c('div',{staticClass:\"list-box\",staticStyle:{\"padding\":\".15rem\"},on:{\"!touchstart\":function($event){return _vm.touchStart($event)},\"!touchend\":function($event){return _vm.touchEnd($event)},\"click\":function($event){return _vm.showDetail(item.goods_id)}}},[_c('img',{staticClass:\"goodsimg\",attrs:{\"slot\":\"img\",\"src\":item.goods.image_url},slot:\"img\"}),_vm._v(\" \"),_c('div',{staticClass:\"list-body\"},[_c('h3',{staticClass:\"goodsname\",attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(_vm._s(item.goods_name))]),_vm._v(\" \"),_c('div',{staticClass:\"btn-numbox\"},[_c('div',[_c('span',{staticClass:\"demo-list-price\"},[_c('em',[_vm._v(\"¥\")]),_vm._v(_vm._s(item.goods.price))])])]),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"other\"},slot:\"other\"},[_c('div',[_c('span',{staticClass:\"time\"},[_vm._v(_vm._s(item.ctime))])])]),_vm._v(\" \"),_c('img',{staticClass:\"right-img\",attrs:{\"slot\":\"other\",\"src\":require(\"../../../static/image/right.png\")},slot:\"other\"})])]),_vm._v(\" \"),_c('div',{staticClass:\"delete\",attrs:{\"data-index\":index},on:{\"click\":_vm.deleteItem}},[_vm._v(\"删除\")])]):_vm._e()}),0)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-7d04605d\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/pages/other/History.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7d04605d\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./History.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./History.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./History.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7d04605d\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./History.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/other/History.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}