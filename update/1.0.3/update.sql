ALTER TABLE `jshop_coupon` DROP `seller_id`;
ALTER TABLE `jshop_coupon` ADD `ctime` BIGINT(12) UNSIGNED NOT NULL COMMENT '创建时间' AFTER `used_id`;


DROP TABLE IF EXISTS `jshop_clerk`;
CREATE TABLE `jshop_clerk` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `store_id` int(10) unsigned DEFAULT NULL COMMENT '店铺ID',
  `user_id` int(10) unsigned DEFAULT NULL COMMENT '用户ID',
  `ctime` bigint(12) unsigned DEFAULT NULL COMMENT '关联时间',
  `utime` bigint(12) unsigned DEFAULT NULL COMMENT '更新时间',
  `isdel` bigint(12) unsigned DEFAULT NULL COMMENT '删除时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COMMENT='店铺店员关联表';



DROP TABLE IF EXISTS `jshop_bill_lading`;
CREATE TABLE `jshop_bill_lading` (
  `id` varchar(20) NOT NULL COMMENT '提货单号',
  `order_id` varchar(20) DEFAULT NULL COMMENT '订单号',
  `store_id` int(10) unsigned DEFAULT NULL COMMENT '提货门店ID',
  `name` varchar(30) DEFAULT NULL COMMENT '提货人姓名',
  `mobile` varchar(15) DEFAULT NULL COMMENT '提货手机号',
  `clerk_id` int(10) unsigned DEFAULT NULL COMMENT '处理店员ID',
  `ptime` bigint(12) unsigned DEFAULT NULL COMMENT '提货时间',
  `status` tinyint(1) unsigned NOT NULL DEFAULT '1' COMMENT '提货状态1=未提货 2=已提货',
  `ctime` bigint(12) unsigned DEFAULT NULL COMMENT '创建时间',
  `utime` bigint(12) unsigned DEFAULT NULL COMMENT '更新时间',
  `isdel` bigint(12) unsigned DEFAULT NULL COMMENT '删除时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='提货单表';

ALTER TABLE `jshop_store`
DROP COLUMN `seller_id`;





--
-- 菜单更新，如果有新增，请勿直接导入
--

DROP TABLE IF EXISTS `jshop_operation`;
CREATE TABLE IF NOT EXISTS `jshop_operation` (
  `id` int(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  `parent_id` int(10) UNSIGNED NOT NULL COMMENT '父ID',
  `name` varchar(50) DEFAULT NULL COMMENT '操作名称',
  `code` varchar(50) DEFAULT NULL COMMENT '操作编码',
  `type` enum('m','c','a') NOT NULL DEFAULT 'a' COMMENT '类型',
  `parent_menu_id` int(10) UNSIGNED NOT NULL COMMENT '菜单id',
  `perm_type` int(1) UNSIGNED NOT NULL DEFAULT '3' COMMENT '权限许可类型，如果为1就是主体权限，， 如果为2就是半主体权限，在左侧菜单不显示，但是在权限菜单上有体现，如果为3就是关联权限',
  `sort` tinyint(3) UNSIGNED DEFAULT '100' COMMENT '操作排序 越小越靠前',
  PRIMARY KEY (`id`),
  KEY `parent_id` (`parent_id`),
  KEY `id` (`id`),
  KEY `parent_menu_id` (`parent_menu_id`),
  KEY `sort` (`sort`)
) ENGINE=InnoDB AUTO_INCREMENT=491 DEFAULT CHARSET=utf8mb4 COMMENT='权限表';

--
-- Dumping data for table `jshop_operation`
--

INSERT INTO `jshop_operation` (`id`, `parent_id`, `name`, `code`, `type`, `parent_menu_id`, `perm_type`, `sort`) VALUES
(2, 1, '管理后台', 'manage', 'm', 1, 1, 200),
(91, 88, '添加物流公司', 'add', 'a', 0, 3, 100),
(155, 129, '商品评价查看', 'getcommentinfo', 'a', 129, 3, 100),
(156, 129, '商品评价回复', 'sellercontent', 'a', 129, 2, 100),
(238, 2, '会员管理', 'User', 'c', 2, 1, 100),
(239, 238, '用户列表', 'index', 'a', 238, 1, 100),
(240, 238, '商品评价', 'comment', 'a', 238, 1, 101),
(242, 238, '积分记录查询', 'pointLog', 'a', 241, 3, 100),
(243, 238, '积分编辑', 'editPoint', 'a', 241, 2, 100),
(244, 2, '控制面板', 'Setting', 'c', 2, 1, 200),
(245, 244, '店铺设置', 'index', 'a', 244, 1, 100),
(246, 2, '支付方式', 'Payments', 'c', 2, 2, 100),
(247, 246, '支付方式列表', 'index', 'a', 244, 1, 100),
(248, 246, '支付方式添加', 'add', 'a', 247, 2, 100),
(249, 246, '支付方式修改', 'edit', 'a', 247, 2, 100),
(250, 246, '支付方式删除', 'del', 'a', 247, 2, 100),
(251, 246, '支付方式启/禁用', 'changeStatus', 'a', 249, 3, 100),
(252, 2, '文章分类', 'ArticleType', 'c', 0, 1, 100),
(253, 252, '文章分类', 'index', 'a', 266, 1, 100),
(254, 252, '文章分类添加', 'add', 'a', 253, 2, 100),
(255, 252, '文章分类修改', 'edit', 'a', 253, 2, 100),
(256, 252, '文章分类删除', 'del', 'a', 253, 2, 100),
(257, 252, '文章添加子分类', 'addson', 'a', 253, 3, 100),
(258, 2, '文章管理', 'Article', 'c', 0, 1, 100),
(259, 258, '文章列表', 'index', 'a', 266, 1, 100),
(260, 258, '文章添加', 'add', 'a', 259, 2, 100),
(261, 258, '文章修改', 'edit', 'a', 259, 2, 100),
(262, 258, '文章删除', 'del', 'a', 259, 2, 100),
(263, 2, '优惠券管理', 'Coupon', 'c', 0, 1, 140),
(264, 263, '优惠券领取列表', 'index', 'a', 361, 2, 100),
(265, 263, '优惠券删除', 'del', 'a', 361, 2, 100),
(266, 2, '运营管理', 'Notice', 'c', 2, 1, 130),
(267, 266, '公告列表', 'index', 'a', 266, 1, 100),
(268, 266, '公告添加', 'add', 'a', 267, 2, 100),
(269, 266, '公告修改', 'edit', 'a', 267, 2, 100),
(270, 266, '公告删除', 'del', 'a', 267, 2, 100),
(271, 2, '广告位管理', 'AdvertPosition', 'c', 0, 1, 100),
(272, 271, '广告位列表', 'index', 'a', 266, 1, 100),
(273, 271, '广告位添加', 'add', 'a', 272, 2, 100),
(274, 271, '广告位修改', 'edit', 'a', 272, 2, 100),
(275, 271, '广告位删除', 'del', 'a', 272, 2, 100),
(276, 271, '广告位启/禁用', 'changeState', 'a', 272, 3, 100),
(277, 2, '广告管理', 'Advertisement', 'c', 0, 1, 100),
(278, 277, '广告列表', 'index', 'a', 266, 1, 100),
(279, 277, '广告添加', 'add', 'a', 278, 2, 100),
(280, 277, '广告修改', 'edit', 'a', 278, 2, 100),
(281, 277, '广告删除', 'del', 'a', 278, 2, 100),
(282, 277, '获取商品', 'getGoods', 'a', 278, 3, 100),
(283, 277, '获取文章', 'getArticle', 'a', 278, 3, 100),
(284, 277, '获取商品名称', 'goodsInfo', 'a', 278, 3, 100),
(285, 277, '获取文章名称', 'articleInfo', 'a', 278, 3, 100),
(286, 2, '品牌管理', 'Brand', 'c', 0, 1, 100),
(287, 286, '品牌列表', 'index', 'a', 305, 1, 30),
(288, 286, '品牌添加', 'add', 'a', 287, 2, 100),
(289, 286, '品牌修改', 'edit', 'a', 287, 2, 100),
(290, 286, '品牌删除', 'del', 'a', 287, 2, 100),
(291, 2, '商品分类', 'Categories', 'c', 0, 1, 100),
(292, 291, '商品分类', 'index', 'a', 305, 1, 20),
(293, 291, '添加商品分类', 'add', 'a', 292, 2, 100),
(294, 291, '编辑商品分类', 'edit', 'a', 292, 2, 100),
(295, 291, '删除商品分类', 'del', 'a', 292, 2, 100),
(296, 2, '订单管理', 'Order', 'c', 2, 1, 120),
(297, 296, '订单列表', 'index', 'a', 296, 1, 90),
(298, 296, '查看订单详情', 'view', 'a', 297, 3, 100),
(299, 296, '编辑订单', 'edit', 'a', 297, 2, 100),
(300, 296, '订单发货', 'ship', 'a', 297, 2, 100),
(301, 296, '取消订单', 'cancel', 'a', 299, 3, 100),
(302, 296, '完成订单', 'complete', 'a', 299, 3, 100),
(303, 296, '删除订单', 'del', 'a', 297, 2, 100),
(304, 296, '物流查询', 'logistics', 'a', 297, 3, 100),
(305, 2, '商品管理', 'Goods', 'c', 2, 1, 110),
(306, 305, '商品列表', 'index', 'a', 305, 1, 10),
(307, 305, '添加商品', 'add', 'a', 306, 2, 100),
(308, 305, '保存商品', 'doAdd', 'a', 307, 3, 100),
(309, 305, '商品评价列表', 'commentList', 'a', 306, 2, 100),
(310, 305, '商品评价详情', 'getCommentInfo', 'a', 309, 3, 100),
(311, 305, '商家回复', 'sellerContent', 'a', 309, 3, 100),
(312, 305, '前台展示状态', 'setDisplay', 'a', 164, 3, 100),
(313, 305, '获取子分类', 'getCat', 'a', 306, 3, 100),
(314, 305, '获取规格信息', 'getSpec', 'a', 306, 3, 100),
(315, 305, '生成多规格', 'getSpecHtml', 'a', 306, 3, 100),
(316, 305, '编辑商品', 'edit', 'a', 306, 2, 100),
(317, 305, '保存编辑商品信息', 'doEdit', 'a', 316, 3, 100),
(318, 305, '批量上下架', 'batchMarketable', 'a', 316, 3, 100),
(319, 305, '批量删除', 'batchDel', 'a', 321, 3, 100),
(320, 305, '商品高级筛选', 'goodsSearch', 'a', 306, 3, 100),
(321, 305, '删除商品', 'del', 'a', 306, 2, 100),
(322, 305, '设置热门或推荐', 'changeState', 'a', 316, 3, 100),
(323, 2, '商品类型管理', 'GoodsType', 'c', 0, 1, 100),
(324, 323, '商品类型', 'index', 'a', 305, 1, 40),
(325, 323, '添加类型', 'add', 'a', 324, 2, 100),
(326, 323, '关联属性', 'addrel', 'a', 324, 3, 100),
(327, 323, '编辑属性', 'edit', 'a', 324, 2, 100),
(328, 323, '删除属性', 'del', 'a', 324, 2, 100),
(329, 323, '关联参数', 'addparams', 'a', 324, 3, 100),
(330, 2, '商品属性', 'GoodsTypeSpec', 'c', 0, 1, 100),
(331, 330, '商品属性', 'index', 'a', 305, 1, 50),
(332, 330, '添加属性', 'add', 'a', 331, 3, 100),
(333, 330, '编辑属性', 'edit', 'a', 331, 3, 100),
(334, 330, '删除属性', 'del', 'a', 331, 3, 100),
(335, 2, '配送方式', 'Ship', 'c', 0, 1, 100),
(336, 335, '配送方式列表', 'index', 'a', 244, 1, 100),
(337, 335, '添加配送方式', 'add', 'a', 336, 2, 100),
(338, 335, '编辑配送方式', 'edit', 'a', 336, 2, 100),
(339, 335, '删除配送方式', 'del', 'a', 336, 2, 100),
(340, 335, '选择地区', 'chooseArea', 'a', 336, 3, 100),
(341, 2, '管理中心', 'Index', 'c', 0, 1, 100),
(342, 341, '首页', 'index', 'a', 241, 1, 10),
(343, 2, '售后单管理', 'BillAftersales', 'c', 0, 1, 100),
(344, 343, '售后单列表', 'index', 'a', 296, 1, 140),
(345, 343, '售后单审核', 'audit', 'a', 344, 2, 100),
(346, 343, '售后单查看', 'view', 'a', 344, 3, 100),
(347, 2, '退货单管理', 'BillReship', 'c', 0, 1, 100),
(348, 347, '退货单列表', 'index', 'a', 296, 1, 160),
(349, 347, '退货单查看', 'view', 'a', 348, 3, 100),
(350, 347, '退货单确认收货', 'confirmReship', 'a', 348, 2, 100),
(351, 2, '退款单管理', 'BillRefund', 'c', 0, 1, 150),
(352, 351, '退款单列表', 'index', 'a', 399, 1, 110),
(353, 351, '退款单查看', 'view', 'a', 352, 3, 100),
(354, 351, '操作退款', 'refund', 'a', 252, 2, 100),
(355, 351, '再次退款', 'reaudit', 'a', 354, 3, 100),
(356, 2, '促销管理', 'Promotion', 'c', 2, 1, 150),
(357, 356, '促销列表', 'index', 'a', 356, 1, 100),
(358, 356, '添加促销', 'add', 'a', 357, 2, 100),
(359, 356, '促销编辑', 'edit', 'a', 357, 2, 100),
(360, 356, '促销删除', 'del', 'a', 357, 2, 100),
(361, 356, '优惠券列表', 'coupon', 'a', 356, 1, 100),
(362, 356, '添加优惠券规则', 'couponAdd', 'a', 361, 2, 100),
(363, 356, '优惠券规则编辑', 'couponEdit', 'a', 361, 2, 100),
(364, 356, '优惠券规则删除', 'couponDel', 'a', 361, 2, 100),
(365, 2, '门店管理', 'Store', 'c', 2, 1, 220),
(366, 365, '门店列表', 'index', 'a', 365, 1, 100),
(367, 365, '门店添加', 'add', 'a', 366, 2, 100),
(368, 365, '门店修改', 'edit', 'a', 366, 2, 100),
(369, 365, '门店删除', 'del', 'a', 366, 2, 100),
(370, 365, '门店地图展现', 'showMap', 'a', 366, 3, 100),
(390, 2, '图片列表', 'images', 'c', 0, 1, 100),
(391, 390, '图片列表', 'index', 'a', 244, 1, 100),
(392, 2, '任务列表', 'ietask', 'c', 0, 1, 100),
(393, 392, '计划任务', 'index', 'a', 244, 1, 100),
(394, 392, '商品导出', 'export', 'a', 306, 3, 100),
(395, 392, '商品导入', 'import', 'a', 306, 3, 100),
(396, 392, '下载导入模板', 'importTemplete', 'a', 306, 3, 100),
(397, 392, '下载文件', 'down', 'a', 393, 3, 100),
(398, 392, '执行下载文件', 'doDown', 'a', 393, 3, 100),
(399, 2, '财务管理', 'BillPayments', 'c', 2, 1, 160),
(400, 399, '支付单列表', 'index', 'a', 399, 1, 100),
(401, 399, '后台支付', 'pay', 'a', 400, 2, 100),
(402, 399, '后台支付实际操作', 'topay', 'a', 401, 3, 100),
(403, 399, '支付单查看', 'index', 'a', 400, 3, 100),
(404, 2, '发货单管理', 'BillDelivery', 'c', 0, 1, 100),
(405, 404, '发货单列表', 'index', 'a', 296, 1, 100),
(406, 404, '发货单详情', 'view', 'a', 405, 3, 100),
(407, 404, '发货单明细', 'items', 'a', 405, 3, 100),
(408, 2, '消息中心', 'MessageCenter', 'c', 0, 1, 100),
(409, 408, '消息配置', 'index', 'a', 244, 1, 100),
(410, 2, '角色管理', 'Role', 'c', 2, 2, 100),
(411, 410, '角色管理', 'index', 'a', 238, 1, 100),
(412, 410, '角色添加', 'add', 'a', 411, 2, 100),
(413, 410, '角色删除', 'del', 'a', 411, 2, 100),
(414, 410, '编辑权限', 'getOperation', 'a', 411, 2, 100),
(415, 410, '角色保存权限', 'savePerm', 'a', 411, 3, 100),
(416, 2, '子账号管理', 'Manage', 'c', 0, 1, 100),
(417, 416, '子账号管理', 'index', 'a', 238, 1, 100),
(418, 416, '管理员添加', 'add', 'a', 417, 2, 100),
(419, 416, '管理员修改', 'edit', 'a', 417, 2, 100),
(420, 416, '管理员删除', 'del', 'a', 417, 2, 100),
(421, 2, '商品参数', 'GoodsParams', 'c', 0, 1, 100),
(422, 421, '参数列表', 'index', 'a', 305, 1, 100),
(423, 421, '添加参数', 'add', 'a', 422, 2, 100),
(424, 421, '编辑参数', 'edit', 'a', 422, 2, 100),
(425, 421, '删除参数', 'del', 'a', 422, 2, 100),
(426, 2, '标签管理', 'Label', 'c', 0, 1, 100),
(427, 426, '设置标签', 'setLabel', 'a', 306, 3, 100),
(428, 426, '设置标签', 'doSetLabel', 'a', 306, 3, 100),
(429, 426, '删除标签', 'delLabel', 'a', 306, 3, 100),
(430, 426, '删除标签', 'doDelLabel', 'a', 306, 3, 100),
(431, 2, '账户余额模块', 'Balance', 'c', 0, 1, 100),
(432, 431, '账户资金管理', 'index', 'a', 399, 1, 150),
(434, 2, '节点控制器', 'Operation', 'c', 2, 3, 100),
(435, 434, '节点管理', 'index', 'a', 244, 1, 255),
(436, 434, '节点删除', 'del', 'a', 435, 2, 100),
(437, 434, '节点编辑', 'add', 'a', 435, 2, 100),
(438, 2, '消息控制器', 'Message', 'c', 1, 3, 100),
(439, 438, '消息管理', 'index', 'a', 238, 1, 200),
(440, 438, '消息删除', 'del', 'a', 439, 3, 100),
(441, 2, '短信控制器', 'Sms', 'c', 1, 3, 100),
(442, 441, '短信管理', 'index', 'a', 238, 1, 255),
(443, 441, '短信删除', 'del', 'a', 442, 3, 100),
(460, 431, '提现列表', 'tocash', 'a', 399, 1, 100),
(461, 431, '提现审核', 'tocashexamine', 'a', 460, 2, 100),
(462, 2, '钩子列表', 'hooks', 'c', 1, 1, 100),
(463, 462, '钩子列表', 'index', 'a', 244, 1, 100),
(464, 2, '插件列表', 'addons', 'c', 1, 1, 100),
(465, 464, '插件列表', 'index', 'a', 244, 1, 100),
(466, 2, '地区管理', 'area', 'c', 1, 3, 100),
(467, 466, '地区管理', 'index', 'a', 244, 1, 100),
(468, 466, '添加地区', 'add', 'a', 467, 2, 100),
(469, 466, '编辑地区', 'edit', 'a', 467, 2, 100),
(470, 466, '删除地区', 'del', 'a', 467, 2, 100),
(471, 462, '添加钩子', 'add', 'a', 463, 2, 100),
(472, 462, '编辑钩子', 'edit', 'a', 463, 2, 100),
(473, 462, '删除钩子', 'del', 'a', 463, 2, 100),
(474, 464, '安装插件', 'install', 'a', 465, 2, 100),
(475, 464, '卸载插件', 'uninstall', 'a', 465, 2, 100),
(476, 464, '插件配置', 'setting', 'a', 465, 2, 100),
(477, 464, '保存配置', 'doSetting', 'a', 465, 3, 100),
(478, 464, '插件启用/停用', 'changeStatus', 'a', 465, 2, 100),
(479, 2, '微信管理', 'Wechat', 'c', 2, 1, 100),
(480, 479, '小程序配置', 'edit', 'a', 479, 1, 100),
(481, 479, '模板列表', 'template', 'a', 479, 1, 100),
(482, 479, '保存配置', 'doEdit', 'a', 479, 2, 100),
(483, 479, '公众号配置', 'official', 'a', 479, 1, 100),
(484, 365, '店员列表', 'clerklist', 'a', 366, 2, 100),
(485, 365, '添加店员', 'addClerk', 'a', 366, 2, 100),
(486, 365, '删除店员', 'delClerk', 'a', 366, 2, 100),
(487, 2, '提货单列表', 'BillLading', 'c', 2, 3, 100),
(488, 487, '提货单列表', 'index', 'a', 296, 1, 100),
(489, 487, '提货单详情', 'info', 'a', 488, 2, 100),
(490, 487, '删除提货单', 'delLading', 'a', 488, 2, 100),
(491, 356, '团购秒杀列表', 'group', 'a', 356, 1, 100),
(492, 356, '添加团购', 'groupAdd', 'a', 491, 2, 100),
(493, 356, '编辑团购', 'groupEdit', 'a', 491, 2, 100),
(494, 356, '删除团购', 'groupdel', 'a', 491, 2, 100);


-- 添加信任登录钩子

INSERT INTO `jshop_hooks` (`name`, `description`, `type`, `addons`, `ctime`, `utime`) VALUES
( 'trustlogin', '信任登录', 1, '', 1541771962, 1541771962),
('trustcallback', '信任登录返回', 1, '', 1541771974, 1541771974);
